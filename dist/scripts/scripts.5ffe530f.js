"use strict";angular.module("visualApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/journal",{templateUrl:"views/journal.html",controller:"JournalCtrl"}).when("/visualizations",{templateUrl:"views/visualizations.html",controller:"VisualizationsCtrl"}).when("/rebalance",{templateUrl:"views/rebalance.html",controller:"RebalanceCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("visualApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("visualApp").controller("JournalCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("visualApp").controller("VisualizationsCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("visualApp").controller("RebalanceCtrl",["$scope",function(a){function b(){var a=d3.select(".rebalance-svg-container").node().getBoundingClientRect().width,b=460,c=12;d={cx:Math.floor(a/2),cy:30,w:60,h:60},d.node={id:0,value:0,labeltext:"0",position:{x:d.cx,y:d.cy},children:{}},d.size=1,d.getVertices=function(){function a(c,d){if(c){var e={id:c.id,labeltext:c.labeltext,position:c.position,parent:d};b.push(e);var f={id:c.id,position:c.position};a(c.children.leftChild,f),a(c.children.rightChild,f)}}var b=[];return a(d.node,{}),b.sort(function(a,b){return a.id-b.id})},d.getEdges=function(){function a(c){function d(d){d&&(b.push({parentId:c.id,parentLabel:c.labeltext,parentPosition:c.position,childId:d.id,childLabel:d.labeltext,childPosition:d.position}),a(d))}d(c.children.leftChild),d(c.children.rightChild)}var b=[];return a(d.node),b.sort(function(a,b){return a.childId-b.childId})},d.addLeaf=function(a){var b=d.size++,c={id:b,value:a,labeltext:a.toString(),position:{},children:{}};d.addNode(c),g(d.node),e()},d.addNode=function(a){function b(b){void 0!=a.value&&(a.value<=b.value?c(b,a):e(b,a))}function c(a,c){a.children.leftChild?b(a.children.leftChild):a.children.leftChild=c}function e(a,c){a.children.rightChild?b(a.children.rightChild):a.children.rightChild=c}b(d.node)},d.removeNode=function(a){function b(a,c,e,f){return a.value==c?(delete e.children[f],a.children.leftChild&&d.addNode(a.children.leftChild),a.children.rightChild&&d.addNode(a.children.rightChild),a):c<=a.value&&a.children.leftChild?b(a.children.leftChild,c,a,"leftChild"):c>a.value&&a.children.rightChild?b(a.children.rightChild,c,a,"rightChild"):!1}b(d.node,a),g(d.node),e()};var e=function(){var a=d3.select("#g_lines").selectAll("line").data(d.getEdges(),function(a){return a.childId});a.transition().duration(500).attr("x1",function(a){return a.parentPosition.x}).attr("y1",function(a){return a.parentPosition.y}).attr("x2",function(a){return a.childPosition.x}).attr("y2",function(a){return a.childPosition.y}),a.enter().append("line").attr("x1",function(a){return a.parentPosition.x}).attr("y1",function(a){return a.parentPosition.y}).attr("x2",function(a){return a.parentPosition.x}).attr("y2",function(a){return a.parentPosition.y}).transition().duration(500).attr("x2",function(a){return a.childPosition.x}).attr("y2",function(a){return a.childPosition.y}),a.exit().remove();var b=d3.select("#g_circles").selectAll("circle").data(d.getVertices(),function(a){return a.id});b.transition().duration(500).attr("cx",function(a){return a.position.x}).attr("cy",function(a){return a.position.y}),b.enter().append("circle").attr("cx",function(a){return a.parent.position.x}).attr("cy",function(a){return a.parent.position.y}).attr("r",c).transition().duration(500).attr("cx",function(a){return a.position.x}).attr("cy",function(a){return a.position.y}),b.exit().remove();var e=d3.select("#g_labels").selectAll("text").data(d.getVertices(),function(a){return a.id});e.text(function(a){return a.labeltext}).transition().duration(500).attr("x",function(a){return a.position.x}).attr("y",function(a){return a.position.y+5}),e.enter().append("text").attr("x",function(a){return a.parent.position.x}).attr("y",function(a){return a.parent.position.y+5}).text(function(a){return a.labeltext}).transition().duration(500).attr("x",function(a){return a.position.x}).attr("y",function(a){return a.position.y+5}),e.exit().remove()},f=function(a){var b=0;return a.children.leftChild||a.children.rightChild?(a.children.leftChild&&(b+=f(a.children.leftChild)),a.children.rightChild&&(b+=f(a.children.rightChild))):b=1,b},g=function(a){function b(b){if(b){var c=d.w*f(b);e+=c,b.position={x:e-(c+d.w)/2,y:a.position.y+d.h},g(b)}}var c=f(a),e=a.position.x-d.w*(c-1)/2;b(a.children.leftChild),b(a.children.rightChild)},h=function(){d3.select(".rebalance-svg-container").append("svg").attr("width",a).attr("height",b).attr("id","treesvg");var e=d3.select("#treesvg").append("g").attr("id","g_lines").selectAll("line").data(d.getEdges(),function(a){return a.childId});e.enter().append("line").attr("x1",function(a){return a.parentPosition.x}).attr("y1",function(a){return a.parentPosition.y}).attr("x2",function(a){return a.childPosition.x}).attr("y2",function(a){return a.childPosition.y});var f=d3.select("#treesvg").append("g").attr("id","g_circles").selectAll("circle").data(d.getVertices(),function(a){return a.id});f.enter().append("circle").attr("cx",function(a){return a.position.x}).attr("cy",function(a){return a.position.y}).attr("r",c);var g=d3.select("#treesvg").append("g").attr("id","g_labels").selectAll("text").data(d.getVertices(),function(a){return a.id});g.enter().append("text").attr("x",function(a){return a.position.x}).attr("y",function(a){return a.position.y+5}).text(function(a){return a.labeltext}),d.addLeaf(7),d.addLeaf(5),d.addLeaf(3),d.addLeaf(6),d.addLeaf(12),d.addLeaf(10),d.addLeaf(4),d.addLeaf(8),d.addLeaf(11)};return h(),d}function c(a,b){return a.value==b?a:b<=a.value&&a.children.leftChild?c(a.children.leftChild,b):b>a.value&&a.children.rightChild?c(a.children.rightChild,b):!1}a.addNode=function(){if(d&&a.addNodeValue){var b=parseInt(a.addNodeValue);d.addLeaf(b),a.addNodeValue=""}},a.findNode=function(){if(d&&a.findNodeValue){{var b=parseInt(a.findNodeValue);c(d.node,b)}a.findNodeValue=""}},a.removeNode=function(){if(d&&a.removeNodeValue){var b=parseInt(a.removeNodeValue);d.removeNode(b)}a.removeNodeValue=""};var d=b()}]);